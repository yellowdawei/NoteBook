你的问题是 **PowerShell 执行策略（Execution Policy）阻止了虚拟环境激活脚本的运行**。这是 Windows PowerShell 的安全限制，但可以轻松解决。

------

## **解决方法（3种方式）**

### **方法 1：临时允许脚本运行（推荐）**

在 PowerShell 中运行以下命令（仅当前会话有效）：

powershell

```
Set-ExecutionPolicy Bypass -Scope Process -Force
.\Activate.ps1
```

- **作用**：临时允许运行脚本，关闭 PowerShell 后恢复默认设置。
- **适用场景**：快速解决问题，不影响系统全局设置。

------

### **方法 2：永久更改执行策略（需管理员权限）**

如果需要长期允许脚本运行（需管理员权限）：

powershell

```
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
```

- **参数说明**：

  - `RemoteSigned`：允许运行本地脚本，但远程下载的脚本需签名。
  - `CurrentUser`：仅对当前用户生效，无需全局修改。

- **验证是否生效**：

  powershell

  ```
  Get-ExecutionPolicy -List
  ```

------

### **方法 3：改用 CMD 或手动激活**

如果不想修改 PowerShell 策略：

#### **(1) 使用 CMD 激活**

cmd

```
D:\Desktop\python\venv\Scripts\activate.bat
```

#### **(2) 手动设置环境变量（无需脚本）**

powershell

```
$env:VIRTUAL_ENV = "D:\Desktop\python\venv"
$env:PATH = "D:\Desktop\python\venv\Scripts;" + $env:PATH
```

------

## **为什么会出现这个问题？**

- PowerShell 默认执行策略是 `Restricted`（禁止运行脚本），防止恶意脚本执行。
- 虚拟环境的 `Activate.ps1` 是 PowerShell 脚本，需明确授权才能运行。

------

## **验证是否激活成功**

运行以下命令检查：

powershell

```
(Get-Command python).Path  # 应指向虚拟环境内的 Python
pip list                   # 应只显示虚拟环境内的包
```

如果路径包含 `venv`，说明激活成功。

------

## **总结**

| 方案             | 命令                                                   | 适用场景                 |
| :--------------- | :----------------------------------------------------- | :----------------------- |
| **临时允许脚本** | `Set-ExecutionPolicy Bypass -Scope Process -Force`     | 快速解决问题，关闭后恢复 |
| **永久允许脚本** | `Set-ExecutionPolicy RemoteSigned -Scope CurrentUser`  | 长期使用 PowerShell 激活 |
| **改用 CMD**     | `cmd /k "D:\Desktop\python\venv\Scripts\activate.bat"` | 不想修改 PowerShell 设置 |